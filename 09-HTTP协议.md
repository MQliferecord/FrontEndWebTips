# HTTP协议

### 同源策略

同源策略是一个安全策略，能够阻隔恶意文档，减少被攻击的媒介。

**什么样的URL算是同源的呢？**

url中以下三个部分都相同，则被认为是符合同源策略。

- protocol（协议）：目前网站广泛使用的http协议和https协议，本地文件的files协议等等。

- port（端口号）:80/8080端口号（！HTTP协议的默认端口号是80，HTTPS协议的默认端口号是443）

- host（主机地址）:ip地址/DNS域名等等。

而当上面任一出现不同，则出现了**跨域**问题。

### 跨域

跨域是一个很常见的问题，解决跨域问题目前主要是两种办法：

- JSONP

JSONP主要利用了JavaScript一个特定的属性，在JavaScript中使用img、iframe、src等标签的特有属性去执行跨域问题。但是JSONP这种解决办法很死板，只能执行GET操作，像是其他HTTP通信中常见的POST/DELETE/OPTIONS等等的操作都无法执行。像是做项目中很常见的使用表单的method去进行form数据的提交到一个action的地址，虽然表单可以选择发送数据的method是post还是get还是其他的方法,但是如果不在js代码中构造响应的axios或者其他ajax的对象，去再次传递相关的数据，仅仅依靠form提交数据的特性，是没办法对服务器端接收到的res.send()的数据进行处理的。

- CORS

CORS是一般是后端写在服务器端的一些指令，前端在使用Nodejs以及其框架的时候也会接触相关的语句。

一下列出几个cors在服务器端经常配置的一些指令：

1. Access-Control-Allow-Origin:对于允许的跨域的地址进行配置，一般来说的默认配置是'*'，意思是允许所有的地址访问。如果被设置成http://127.0.0.1，意思就是只允许这个地址进行端口的访问，其他的地址都无法访问这个网页。

2. Access-Control-Allow-Headers:网页信息传递的编码格式，一般默认设置是Content-type，表示允许所有的格式进行跨域信息的传输。常见的Content-type有application/x-www-form-unlencoded（表单数据的默认传送格式），multiple/form-data（也是表单传送的常见可选格式，当需要去传送提交文件的时候，就需要将axios的headers去设置为multiple/form-data），application/json、application/xml等等

3. Access-Control-Allow-Methods:常见的请求类型，比如get/post/options/delete

4. Access-Control-Max-Age:最长缓存时间，如果需要像服务器发送数据的时候，相关数据在服务器的最长的存储时间。

> 除了以上两种方法，实际上并没有其他的方法去解决跨域问题，所谓的axios/ajax/fetch/xhrhttprequest本质上还是在服务器端进行了cors的设置使得能够接受跨域的允许。

### HTTP协议

规定了浏览器和服务器之间的通信规则。包括了请求报文和响应报文，都会显示在浏览器的网络tags中。

- 请求报文

**请求行**

1. 请求类型:GET/POST/OPTIONS/DELETE等等请求。

> 面试题1：GET和POST有什么区别。

get请求往往是只给服务器发送数据，并不关心服务器返回了什么数据，post请求也是给服务器去发送一个请求，但是往往需要服务器去响应一个回应。options是有点特殊，它是在发送除了get请求之外的请求给服务器的时候，服务器会先返回一个OPTIONS请求，再返回相应的请求。OPTIONS请求的意思是预检，也就是响应客户端，服务器能够回应响应请求。

2. URL

3. 协议版本:HTTP/1.0、HTTP/1.1、HTTP/2.0

> 面试题2：简要描述一些HTTP协议的版本。

HTTP/1.0、HTTP/1.1、HTTP/2.0。

HTTP/1.0一些简单的网页请求以及网络请求。

HTTP/1.1：增加了更多的缓存处理机制；添加了更多的状态码；增加了断点续传功能，允许只发送对象的某个部分；请求头增加了HOST；能够实现长连接，keep-active，使得通信主动断开前，保持connection的长时间的连通，能够一直发送多个请求，不再像HTTP1.0的时候一次连接只能发送一个请求，连接就会关闭。能够节省很多重复打开连接关闭连接的时间。加快网络的通信过程。

HTTP2.0：首先HTTP1.1的解析方式是使用文本格式，所以Content-type会有各种文本格式的指定，但是本身文本格式的一个解析和信息传递是具有一个天然的缺陷，所以HTTP2.0采用了二进制的通信方式，只有0和1两个数字，稳定性得到了大幅度的提升；多路复用，即连接共享，HTTP1.1的串行单线程连接有一个显著的缺陷就是队头阻塞，它是一个个请求进行发送，所以如果中间一个请求收不到服务器端的回复，通信过程就会被阻塞在这个请求，而多路复用会使得请求并行执行，导致一个阻塞并不会影响其他的请求。headers信息的压缩，使得重复的header信息不需要再次发送，节约了传输大小；服务器推送，会在请求发送的过程将该网页用到的一些数据一并发过来，这样就节约了客户端重复发请求要求数据的过程，极大节约了通信时间。

**请求头**

1. Host:baidu.com 

2. Cookie:name=MQ 

> 面试题3：简要描述Cookie/LocalStorage/SessionStorage的区别。

三者都是本地存储，不同是的Cookie一般用于存储和服务器进行通信的信息，比如username/password，这些在每次连接服务器时，都需要发送给服务器的信息。LocalStorage则是用来保存长期需要静态存储的信息，它不需要在和服务器端进行通信的时候发送过去，并且会在一定的缓存时间内将信息存储在浏览器，并不会随着浏览器会话的关闭而丢失。SessionStorage是会话存储，一旦网页关闭，存在是sessionstorage中的信息就会丢失，并且它也是一种静态存储。

3. Content-Type:application/x-www-form-urlencoded：

4面试题4：Keep-alive在http响应中起到了什么作用。

Keep-alive(一直保持连接)是HTTP1.1添加的属性，保持connection的长时间的连通，能够一直发送多个请求，不再像HTTP1.0的时候一次连接只能发送一个请求，连接就会关闭。能够节省很多重复打开连接关闭连接的时间。加快网络的通信过程。

 **请求内容**

username=admin&password=admin：有时候会进行的一个加密，所以一般会需要axios里header或者文件传输的时候使用去进行一些格式的转化或者解码编码操作。

- 响应报文

**响应行**

 1. 协议版本:HTTP/1.0、HTTP/1.1、HTTP/2.0

 2. 状态码 
 
 > 面试题5：简要描述你知道的状态码。
 
 200(成功)/304(重刷新网页没有发生变化，一般是出现在固定的一个展示网页)/404(请求的资源不存在)/500(连接不到服务器)/100（正在处理）/204（查找网页没有信息改变，一般在搜索页面输入信息后页面没有刷新返回204）

**响应头**

 Content-Type:text/html;charset=utf-8

 Content-length:2048

 Content-encoding:gzip

 **响应体**

 DOM结构




